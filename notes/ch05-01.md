# Chapter 05 (上) - 开发你的第一个 MCP

> 听完 Ch05（上），你对 MCP 开发有了什么新认识？欢迎你分享。

## 1. MCP 开发的意义：从使用者到创造者

从 MCP 的"使用者"转变为"创造者"具有重要意义：

-   **满足个性化需求**：现有 MCP 应用难以完全满足高度定制化的需求。
-   **深入理解机制**：亲手开发能更深入了解 MCP 内部运作，更精准评判应用质量。
-   **识别协议局限**：全面认识 MCP 协议的局限性，更好地把握其最佳应用场景。
-   **参与生态建设**：思考 MCP 未来发展方向，并参与到不断完善的系统建设中。
-   **寻找套利机会**：在 AI 时代，掌握 MCP 开发能力有助于发现和利用新的价值点。

## 2. MCP 核心概念与架构

从开发者的视角看，MCP 本质上是一套标准协议，定义了客户端（Client）与服务器端（Server）如何交互。

-   **Client (客户端)**：日常使用的 AI 工具（如 Tree、ChatGPT），通常无需开发者构建。
-   **Server (服务端)**：开发者构建的 MCP 应用，为 Client 提供工具和能力。
-   **Protocol (协议)**：Client 和 Server 之间基于 JSON 的标准化沟通语言。
-   **交互流程**：握手（能力协商）→ 交互（调用工具/资源）→ 关闭连接。
-   **价值**：解决工具割裂、执行效率低、缺乏统一标准的问题；实现一次开发多平台通用、工具与 AI 解耦、易于测试调试。

## 3. MCP 的三大核心组件

MCP Server 的能力基石由以下三大组件构成：

### 3.1 工具 (Tools)

-   **作用**：帮助大型语言模型（LLM）执行对话中难以实现的操作或特定功能。
-   **特点**：
    -   AI 可以主动调用。
    -   需要定义输入参数和返回值。
    -   用于执行操作（计算、查询、修改数据等）。
    -   通过 Python 函数 + 装饰器实现。
    -   决定了 MCP 可以做什么。
-   **设计建议**：工具应精简明确，避免过多功能。

### 3.2 资源 (Resources)

-   **作用**：提供 Server 端的特定数据，通常是只读的。
-   **特点**：
    -   AI 可以列举和读取。
    -   通常用 URI（如`file:///path/to/file`）进行唯一标识。
    -   支持订阅机制（资源变化时主动通知 Client）。
    -   用于提供上下文信息（如代办事项、用户资料、文件内容）。
    -   决定了 MCP 可以有什么。
-   **设计建议**：资源传输应优化（如传文件路径而非内容）。

### 3.3 提示模板 (Prompt Templates)

-   **作用**：预先配置并提供给 Client 使用的模板，规范 LLM 如何调用工具。
-   **特点**：
    -   预设的提示词模板。
    -   可以包含参数（动态填充）。
    -   帮助用户快速开始对话。
    -   确保 LLM 在特定情境下以更可靠、更稳定的方式调用工具，避免不确定性。
    -   决定了 MCP 的复用能力。

## 4. 实践：开发第一个 MCP Server

-   **框架**：推荐使用 FastMCP 简化开发。
-   **基本步骤**：
    1.  安装 UV 环境管理工具。
    2.  创建项目目录并初始化环境。
    3.  安装 FastMCP 依赖。
    4.  编写 Server 代码（定义工具和资源，用装饰器声明）。
    5.  启动 Server（默认使用 Stdio 本地传输）。
-   **示例功能**：
    -   **工具**：字符串回显（echo）、加法计算（add）。
    -   **资源**：读取文件内容（支持动态文件名）。
-   **测试方式**：
    -   在 Cursor IDE 中配置 MCP Server 并对话测试。
    -   使用官方 MCP Inspector 工具进行调试（命令行启动，网页可视化操作）。

### 常见问题与调试技巧

-   **环境问题**：确保 Python 环境激活、路径正确。
-   **配置问题**：JSON 格式严格校验，注意引号、逗号。
-   **调试技巧**：添加日志、使用 Inspector 工具排查。

### 教程

MCP 开发教程：https://github.com/huoshuiai42/mcp-courseware
