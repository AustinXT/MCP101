# Chapter 03 - 核心工作场景（上）

> 听完 Ch03，你对 MCP 核心工作场景有了什么新认识？欢迎你分享。

## 一、MCP 工作场景概述

### 1. 为什么需要对 MCP 工具进行场景化分类？

随着 MCP 工具库的不断扩大，如何高效管理和选择合适的工具成为关键挑战。传统的按功能分类方式（如搜索功能、格式转换功能）只能回答"工具能做什么"，却无法回答"应该在什么场景下使用它"。

**更优的方案是按工作场景分类**，因为：
- 相同类型的工作场景，解决问题的套路相似，工具可以复用
- 人天然处于情景中思考，基于场景思考认知负担更小
- 复杂工作场景往往需要多个工具配合，而非单一工具

### 2. MCP 工作场景的二维分类框架

基于两个核心维度，可以将工作场景划分为四个象限：

**维度一：工作对象**
- **事务型**：以具体的事情为中心（如独自撰写周报）
- **沟通型**：以人为中心（如项目管理需要与同事协调）

**维度二：信息载体**
- **文本型**：以文字形式进行（如撰写报告、发送邮件）
- **非文本型**：以语音、图像或视频形式进行（如视频会议、文生图）

**四种核心工作场景：**
1. **文本事务型**：撰写报告、市场调研、产品文案
2. **文本沟通型**：发邮件、日程管理、团队协作
3. **非文本事务型**：文生图、图表制作
4. **非文本沟通型**：视频会议、语音交流

## 二、文本事务型场景：独立完成文字类任务

这是最常见的工作场景，工作者独自完成任务，很少涉及实时的跨部门或跨团队沟通。

### 高频任务 1：信息搜索

**推荐工具：**

1. **Jina AI MCP** ⭐⭐⭐⭐⭐
   - 网页搜索功能
   - 扩展查询（expand_query）：自动搜索更多相关信息
   - 内容筛选和排序（sort_by_relevance）：根据匹配度重新排序
   - 可指定返回结果数量，有效降低 Token 消耗
   - 网页读取和内容提取

2. **发现报告 (fxbaogao-mcp)**
   - 专门搜索大型数据库中的报告信息
   - 适合需要行业报告和研究资料的场景

### 高频任务 2：信息整理

**推荐工具：**

1. **PDF2Markdown (pymupdf4llm-mcp)** ⭐⭐⭐⭐⭐
   - 将 PDF 转换为 Markdown 格式
   - Markdown 是大模型最容易接受的原生态格式
   - 便于后续加工和修改

2. **Word_Document**
   - 读取 Word 文档的内容和数据
   - 可将内容整合到现有报告框架中
   - ⚠️ 注意：不建议用于生成 Word 文档（速度很慢）

**小技巧：** 搜索到的信息先保存为 md 格式，便于后续修改和处理。

非文本转文本：文档智能处理

**核心理念：** 转换不是目的，更重要的是**理解、提取、组织和利用文档中的信息和知识**。这背后的需求是文档智能（Document Intelligence, DI）。

### 高频任务 3：非文本转文本

| 格式 | 核心技术 | 代表工具 | 主要难点 |
|---|---|---|---|
| **图片** | OCR + Layout Analysis + IDP | PaddleOCR, LayoutLM, Donut | 复杂表格、多语言混排、印章水印干扰 |
| **音频** | ASR + Speaker Diarization | OpenAI Whisper, pyannote.audio | 说话人分离、实时转写延迟、口语化表达 |
| **视频** | ASR + OCR + 多模态分析 | FFmpeg + Whisper + PaddleOCR | 多模态信息融合、时序逻辑连贯性 |
| **PDF 扫描件** | OCR + 智能版面恢复 | Amazon Textract, LayoutLMv3 | 复杂版面、跨页表格、手写签名识别 |
| **PPT** | XML 解析 + OCR + 语义提取 | python-pptx, PaddleOCR | SmartArt 结构化、嵌入对象提取 |
| **Word** | XML 解析 + 结构化语义提取 | python-docx, spaCy/LangChain | 复杂表格、修订模式、公式还原 |
| **Excel** | XML 解析 + 数据类型推断 | pandas, openpyxl | 合并单元格、公式依赖链、大数据量处理 |

#### 详细技术解析

##### 1. 图片处理流程
```
图像预处理（去噪/增强）
→ 版面分析（文本/表格/图像区域分割）
→ 字符识别（OCR核心）
→ 语言模型后处理（纠错/标点）
→ 结构化提取（键值对/表格/实体识别）
```

##### 2. 音频处理流程
```
声学特征提取（MFCC/Mel频谱）
→ 声学模型（Transformer-based CTC/Attention）
→ 语言模型解码（N-gram/Transformer）
→ 说话人分离（Diarization）
→ 后处理（标点/分段/口语转书面语）
```

##### 3. 视频处理流程
```
音频部分：分离音频轨道 → ASR转写 + 说话人分离
视频部分：关键帧提取 → OCR识别画面文字 + 视觉理解
整合：多模态信息按时间戳对齐 → 生成结构化描述/摘要
```

## 三、文本沟通型场景：通过文字与他人交流

工作重心以人为中心，通过文字形式与他人交流和协调。

### 高频任务 1：信息同步

**推荐工具：**

1. **邮箱服务器 (mcp-email-server)**
   - 通过与 AI 聊天的方式发送和接收邮件
   - 自动化邮件处理

2. **企业微信机器人 (wecom-bot-mcp-server)**
   - 控制企业微信内建机器人发布信息
   - 适合同时向多个内部群发送相同通知
   - ⚠️ 注意：只能在企业内部群使用

### 高频任务 2：事务协同

**推荐工具：**

1. **钉钉 MCP (dingtalk-mcp)**
   - 日程管理：添加、删除或修改会议日程
   - 获取成员联系信息
   - ⚠️ 配置复杂：需要注册为钉钉开发者，创建应用，获取 Client ID 和 Client Secret

## 四、实践建议

### 1. 工具选择策略
- 优先确定工作场景类型（事务型/沟通型，文本型/非文本型）
- 在场景下选择高频任务对应的工具组合
- 工具之间要能无缝配合，形成工作流

### 2. 信息处理最佳实践
- **格式优先**：优先转换为 Markdown 格式，便于大模型处理
- **分步处理**：搜索 → 转换 → 整理 → 生成，每步使用专门工具
- **保存中间结果**：及时保存 md 文件，避免重复工作

### 3. 工具配置建议
- 提前完成复杂工具的配置（如钉钉 MCP 的开发者认证）
- 逐个试用工具，了解其功能和限制
- 使用规则（rule）限定 MCP 的行为，提高准确性

### 4. 成本优化
- 利用 Jina AI 的筛选功能，减少不必要的 Token 消耗
- 大文件优先转换格式，再用大模型处理
- 避免用 MCP 生成复杂格式文档（如 Word），改为读取和修改

## 五、参考资源

### 文本事务型工具
- [Jina AI MCP](https://mp.weixin.qq.com/s/pZJr7-rfalOhZ1XRIOjGzw)
- [发现报告](https://www.fxbaogao.com/)
- [PDF2Markdown](https://modelscope.cn/mcp/servers/@ai-zerolab/pymupdf4llm-mcp)
- [Word_Document](https://www.modelscope.cn/mcp/servers/BXSBLA/Word_Document)

### 文本沟通型工具
- [邮箱服务器](https://modelscope.cn/mcp/servers/@ai-zerolab/mcp-email-server)
- [企业微信机器人](https://modelscope.cn/mcp/servers/@loonghao/wecom-bot-mcp-server)
- [钉钉 MCP](https://modelscope.cn/mcp/servers/@open-dingtalk/dingtalk-mcp)